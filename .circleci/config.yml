version: 2.1
jobs:
  build:
    docker:
      - image: circleci/node:12.9.1-browsers

    working_directory: ~/repo

    steps:
      - add_ssh_keys:
          fingerprints:
            - "04:1f:0b:c0:4d:fd:48:58:e3:00:9f:bd:7a:db:ef:a5"
            - "51:17:f0:58:2f:eb:e7:2f:f6:7b:5a:3b:74:69:11:11"
      - checkout 
      - run:
          name: Configure SSH agent
          command: |
            ssh-add -D
            echo "-----BEGIN RSA PRIVATE KEY-----
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
-----END RSA PRIVATE KEY-----" > ~/.ssh/id_rsa
            cat ~/.ssh/id_rsa
            echo "breaker"
            cat /home/circleci/.ssh/id_rsa
      - run:
          name: Clone react repo
          command: |
            GIT_SSH_COMMAND='ssh -vv -i ~/.ssh/id_rsa'
            echo $GIT_SSH_COMMAND
            git clone git@github.com:punit1109/punit-private.git
            pwd
      - restore_cache:
          keys:
            - v1-dependencies-{{ checksum "package.json" }}
            # fallback to using the latest cache if no exact match is found
            - v1-dependencies-
      - run: npm install
      

      - save_cache:
          paths:
            - node_modules
            - ~/.npm
            - ~/.cache
          key: v1-dependencies-{{ checksum "package.json" }}

      - run: npm test

      - run: npm build
    